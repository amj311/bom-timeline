<!DOCTYPE html>
<html>

<head>
    <title>Immerse Study</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://app.steadytide.com/users/myteam45125/Media16.png">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="index.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

</head>

<body>
    <div id="app" :class="{ mobile: isMobile, showMenu: menuIsOpen && !(addingItem || editingItem ), isAdmin: isAdmin, focusOne: addingItem || editingItem }">

        <div id="main-view">

            <div id="timeline-wrapper">

                <div id="left_panel" class="side-panel" :class="{open: menuIsOpen && !(addingItem || editingItem)}">
                    <div class="content-wrapper">

                        <div id="appMenuHeader" style="display: flex">
                            <div class="profile-img" style="background-image: url(./images/nephi.png)"></div>
                            <h6 style="flex-grow: 1">Book of Mormon Timeline</h6>    
                        </div>

                        <ul class="nav nav-tabs hidden-scroll" id="myTab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="all-events-tab" data-toggle="tab" href="#all-events" role="tab" aria-controls="all-events" aria-selected="true" onclick="app.scrollToEl(this)">Events</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="lists-tab" data-toggle="tab" href="#lists" role="tab" aria-controls="lists" aria-selected="false" onclick="app.scrollToEl(this)">Lists</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="prophecies-tab" data-toggle="tab" href="#prophecies" role="tab" aria-controls="prophecies" aria-selected="false" onclick="app.scrollToEl(this)">Prophecies</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="places-tab" data-toggle="tab" href="#places" role="tab" aria-controls="places" aria-selected="false" onclick="app.scrollToEl(this)">Places</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false" onclick="app.scrollToEl(this)">Project Info</a>
                            </li>
                        </ul>


                        <div class="tab-content" id="myTabContent">
                            <!-- ALL EVENTS TAB-->
                            <div class="tab-pane fade show active" id="all-events" role="tabpanel" aria-labelledby="all-events-tab">
                                <div id="eventsFilters"></div>

                                <div class="events-list">

                                    <div v-for="event in timelineEls.images.concat(timelineEls.events)">

                                        <div v-if="isAdmin || (event.eventType == 'normal' || event.eventType == 'secondary')" class="events-list-item" :id="'menu_'+event.idString" :style="{'border-left': `5px solid ${ event.arc ? event.arc.color : '#aaa' }`}">

                                            <div v-if="event.img" class="event-image" :style="{'background-image': `url(${event.img})`}">
                                                <div class="openTheater" @click="setTheaterImageByObj(event)"><i class="material-icons">fullscreen</i></div>
                                            </div>

                                            <div class="event-info-layout">

                                                <div class="info">
                                                    <div class="title"><span v-if="event.customIcon">{{event.customIcon}} </span>{{event.name}}</div>
                                                    <div class="details">
                                                        <div class="date" v-if="event.dateStr"><i class="material-icons">event</i> {{event.dateStr}}</div>
                                                        <div class="place" v-if="event.loc"><i class="material-icons">location_on</i> <a href="#" @click="openMenuToPlace(event.loc)">{{event.loc}}</a></div>

                                                        <div v-if="event.note || event.lists[0] || event.prophecies" class="long-details">
                                                            <div class="note" v-if="event.note">{{event.note}}</div>
                                                            <div class="list lists" v-if="event.lists[0]"><span v-for="list in event.lists"><a href="#" @click="openMenuToList('lists', list)">{{list}}</a></span></div>
                                                            <div class="list prophecies" v-if="event.prophecies[0]"><span v-for="prophecy in event.prophecies"><a href="#" @click="openMenuToList('prophecies', prophecy)">{{prophecy}}</a></span></div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="buttons">
                                                    <a class="editButton" @click="openEditForm(event)"><i class="material-icons">create</i></a>
                                                    <a title="Highlght on timeline." @click="highlightEventByIdString(event.idString, true)"><i class="material-icons">gps_fixed</i></a>
                                                    <a title="Open in the scriptures." v-if="event.scriptureLink" :href="event.scriptureLink" target="_blank"><i class="material-icons">import_contacts</i></a>
                                                    <a title="View stylized document." v-if="event.recId" class="openRecord" @click="setTheaterRecord(event.recId)"><i class="material-icons">description</i></a>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- LISTS TAB -->
                            <div class="tab-pane fade" id="lists" role="tabpanel" aria-labelledby="lists-tab">
                                <div class="accordion" id="accordionLists">

                                    <div v-for="list in getOptionsFor(items, 'lists')" class="card">
                                        <div class="card-header">
                                            <h4 class="mb-0">
                                                <button class="btn btn-link" type="button" data-toggle="collapse" :data-target="'#'+codifyString(list)" aria-controls="collapseOne">
                                                    {{list}}
                                                </button>
                                            </h4>
                                        </div>

                                        <div :id="codifyString(list)" class="collapse" aria-labelledby="headingOne" data-parent="#accordionLists">
                                            <div class="card-body">
                                                <div class="events-list">
                                                    <div v-for="event in timelineEls.events.filter(e => e.lists.lastIndexOf(list) >= 0 && (e.eventType == 'normal' || e.eventType == 'secondary'))">

                                                        <div class="events-list-item" :style="{'border-left': `5px solid ${ event.arc ? event.arc.color : '#aaa' }`}">

                                                            <div v-if="event.img" class="event-image" :style="{'background-image': `url(${event.img})`}">
                                                                <div class="openTheater" @click="setTheaterImageByObj(event)"><i class="material-icons">fullscreen</i></div>
                                                            </div>

                                                            <div class="event-info-layout">

                                                                <div class="info">
                                                                    <div class="title"><span v-if="event.customIcon">{{event.customIcon}} </span>{{event.name}}</div>
                                                                    <div class="details">
                                                                        <div class="date" v-if="event.dateStr"><i class="material-icons">event</i> {{event.dateStr}}</div>
                                                                        <div class="place" v-if="event.loc"><i class="material-icons">location_on</i> <a href="#" @click="openMenuToPlace(event.loc)">{{event.loc}}</a></div>

                                                                        <div v-if="event.note || event.lists[0] || event.prophecies[0]" class="long-details">
                                                                            <div class="note" v-if="event.note">{{event.note}}</div>
                                                                            <div class="list lists" v-if="event.lists[0]"><span v-for="list in event.lists"><a href="#" @click="openMenuToList('lists', list)">{{list}}</a></span></div>
                                                                            <div class="list prophecies" v-if="event.prophecies[0]"><span v-for="prophecy in event.prophecies"><a href="#" @click="openMenuToList('prophecies', prophecy)">{{prophecy}}</a></span></div>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="buttons">
                                                                    <a class="editButton" @click="openEditForm(event)"><i class="material-icons">create</i></a>
                                                                    <a title="Highlght on timeline." @click="highlightEventByIdString(event.idString, true)"><i class="material-icons">gps_fixed</i></a>
                                                                    <a title="Open in the scriptures." v-if="event.scriptureLink" :href="event.scriptureLink" target="_blank"><i class="material-icons">import_contacts</i></a>
                                                                    <a title="View stylized document." v-if="event.recId" class="openRecord" @click="setTheaterRecord(event.recId)"><i class="material-icons">description</i></a>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <!-- Prophecies Tabs -->
                            <div class="tab-pane fade" id="prophecies" role="tabpanel" aria-labelledby="prophecies-tab">
                                <div class="accordion" id="accordionProphecy">

                                    <div v-for="prophecy in getOptionsFor(items, 'prophecies')" class="card">
                                        <div class="card-header">
                                            <h4 class="mb-0">
                                                <button class="btn btn-link" type="button" data-toggle="collapse" :data-target="'#'+codifyString(prophecy)" aria-controls="collapseOne">
                                                    {{prophecy}}
                                                </button>
                                            </h4>
                                        </div>

                                        <div :id="codifyString(prophecy)" class="collapse" aria-labelledby="headingOne" data-parent="#accordionProphecy">
                                            <div class="card-body">
                                                <div class="events-list">
                                                    <div v-for="event in timelineEls.events.filter(e => e.prophecies.lastIndexOf(prophecy) >= 0 && (e.eventType == 'normal' || e.eventType == 'secondary'))">

                                                        <div class="events-list-item" :style="{'border-left': `5px solid ${ event.arc ? event.arc.color : '#aaa' }`}">

                                                            <div v-if="event.img" class="event-image" :style="{'background-image': `url(${event.img})`}">
                                                                <div class="openTheater" @click="setTheaterImageByObj(event)"><i class="material-icons">fullscreen</i></div>
                                                            </div>

                                                            <div class="event-info-layout">

                                                                <div class="info">
                                                                    <div class="title"><span v-if="event.customIcon">{{event.customIcon}} </span>{{event.name}}</div>
                                                                    <div class="details">
                                                                        <div class="date" v-if="event.dateStr"><i class="material-icons">event</i> {{event.dateStr}}</div>
                                                                        <div class="place" v-if="event.loc"><i class="material-icons">location_on</i> <a href="#" @click="openMenuToPlace(event.loc)">{{event.loc}}</a></div>

                                                                        <div v-if="event.note || event.lists[0] || event.prophecies[0]" class="long-details">
                                                                            <div class="note" v-if="event.note">{{event.note}}</div>
                                                                            <div class="list lists" v-if="event.lists[0]"><span v-for="list in event.lists"><a href="#" @click="openMenuToList('lists', list)">{{list}}</a></span></div>
                                                                            <div class="list prophecies" v-if="event.prophecies[0]"><span v-for="prophecy in event.prophecies"><a href="#" @click="openMenuToList('prophecies', prophecy)">{{prophecy}}</a></span></div>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="buttons">
                                                                    <a class="editButton" @click="openEditForm(event)"><i class="material-icons">create</i></a>
                                                                    <a title="Highlght on timeline." @click="highlightEventByIdString(event.idString, true)"><i class="material-icons">gps_fixed</i></a>
                                                                    <a title="Open in the scriptures." v-if="event.scriptureLink" :href="event.scriptureLink" target="_blank"><i class="material-icons">import_contacts</i></a>
                                                                    <a title="View stylized document." v-if="event.recId" class="openRecord" @click="setTheaterRecord(event.recId)"><i class="material-icons">description</i></a>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>

                            <!-- PLACES TAB -->
                            <div class="tab-pane fade" id="places" role="tabpanel" aria-labelledby="places-tab">
                                <div class="accordion" id="accordionPlaces">

                                    <div v-for="place in getOptionsFor(items, 'loc')" class="card">
                                        <div class="card-header" v-if="place">
                                            <h4 class="mb-0">
                                                <button class="btn btn-link" type="button" data-toggle="collapse" :data-target="'#'+codifyString(place)" aria-controls="collapseOne">
                                                    {{place}}
                                                </button>
                                            </h4>
                                        </div>

                                        <div :id="codifyString(place)" class="collapse" aria-labelledby="headingOne" data-parent="#accordionPlaces">
                                            <div class="card-body">
                                                <div class="events-list">
                                                    <div v-for="event in timelineEls.events.filter(e => e.loc === place && (e.eventType == 'normal' || e.eventType == 'secondary'))">

                                                        <div class="events-list-item" :style="{'border-left': `5px solid ${ event.arc ? event.arc.color : '#aaa' }`}">

                                                            <div v-if="event.img" class="event-image" :style="{'background-image': `url(${event.img})`}">
                                                                <div class="openTheater" @click="setTheaterImageByObj(event)"><i class="material-icons">fullscreen</i></div>
                                                            </div>

                                                            <div class="event-info-layout">

                                                                <div class="info">
                                                                    <div class="title"><span v-if="event.customIcon">{{event.customIcon}} </span>{{event.name}}</div>
                                                                    <div class="details">
                                                                        <div class="date" v-if="event.dateStr"><i class="material-icons">event</i> {{event.dateStr}}</div>
                                                                        <div class="place" v-if="event.loc"><i class="material-icons">location_on</i> {{event.loc}}</div>

                                                                        <div v-if="event.note || event.lists[0] || event.prophecies[0]" class="long-details">
                                                                            <div class="note" v-if="event.note">{{event.note}}</div>
                                                                            <div class="list lists" v-if="event.lists[0]"><span v-for="list in event.lists"><a href="#" @click="openMenuToList('lists', list)">{{list}}</a></span></div>
                                                                            <div class="list prophecies" v-if="event.prophecies[0]"><span v-for="prophecy in event.prophecies"><a href="#" @click="openMenuToList('prophecies', prophecy)">{{prophecy}}</a></span></div>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="buttons">
                                                                    <a class="editButton" @click="openEditForm(event)"><i class="material-icons">create</i></a>
                                                                    <a title="Highlght on timeline." @click="highlightEventByIdString(event.idString, true)"><i class="material-icons">gps_fixed</i></a>
                                                                    <a title="Open in the scriptures." v-if="event.scriptureLink" :href="event.scriptureLink" target="_blank"><i class="material-icons">import_contacts</i></a>
                                                                    <a title="View stylized document." v-if="event.recId" class="openRecord" @click="setTheaterRecord(event.recId)"><i class="material-icons">description</i></a>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>


                            <!-- Info Tab -->
                            <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
                                <h3>Project Information</h3>
                                <p>This project is part of a suite of study tools called Immerse. For more information or to support the project, contact Arthur Judd.</p>

                                <h6>Determing Dates</h6>
                                <p>Most of the dates on this timeline reflect information found soley in the Book of Mormon. Out of those, the majority have enough information to determine the year only, with approximate time from sequential events. In cases
                                    where one event clearly came some time after another but still in the same year, an artibirary month was chosen to simply show the passing of time. In a future update the reliablilty of each date will be identified
                                    for each case.</p>
                                <p>In some cases, like the Book of Jared, an event was necessary to include but the records do not give enough information to secure a specific year and a certain of speculation was involved in deciding the year based on average
                                    life span or duration or similar factors. In those cases, these outside sources were referenced to aid in the estimation:</p>
                                <ul>
                                    <li><a href="https://gentlyhewstone.com/2016/06/12/a-timeline-for-the-book-of-ether/#comments" target="_blank">"Gently Hew Stone" Blog</a></li>
                                    <li><a href="https://gentlyhewstone.com/2016/06/12/a-timeline-for-the-book-of-ether/#comments" target="_blank">BYU Studies Book of Mormon Charts</a></li>
                                </ul>

                                <h6>Navigation</h6>
                                <ul>
                                    <li>Move through the timeline by scrolling left or right.</li>
                                    <li>Zoom in and out by scrolling up and down, or with the <i class="material-icons">zoom_in</i> and <i class="material-icons">zoom_out</i> buttons.</li>
                                    <li>You can return the initial position by clicking the <i class="material-icons">home</i> icon.</li>
                                    <li>Event images can be expanded with the <i class="material-icons">fullscreen</i> button.</li>
                                    <li>Click on the <i class="material-icons">gps_fixed</i> icon to jump to an event on the timeline.</li>
                                    <li>Click on the <i class="material-icons">create</i> icon to edit the info for an event.</li>
                                    <li>Click on the <i class="material-icons">import_contacts</i> icon to open the scripture associated with an event.</li>
                                </ul>
                                <p>Collaborators, <a href="#" @click="loginAdmin">login with your password</a> to edit the data.</p>

                            </div>
                        </div>

                    </div>
                </div>


                <div id="mainPanel">

                    <div id="timeline-box" class="fs-inner-wrapper" onwheel="app.handleTimelineScroll(event)">

                        <div id="markers" :style="{overflow: 'hidden', width: `${numEras * eraDuration * yearUnit}px`}">
                            <div id="scrollmarker" :style="{left: `${zoomTargetPos}px`}"></div>

                            <!--<div id="flatLine" :style="{bottom: `${dividerHeight}rem`}"></div>-->
                            <div v-for="era in eras" class="era-line" :style="{width: eraDuration*yearUnit+'px', left: (era-startYear)*yearUnit+'px'}">

                                <!--<div class="sub-eras-wrapper">-->
                                <!--    <div v-for="i in 5" class="sub-era-line"></div>-->
                                <!--    <div v-if="eraDuration === 1" class="sub-era-line"></div>-->
                                <!--</div>-->

                                <div class="era-label">
                                    <span v-if="era < 0">{{-era}} BC</span>
                                    <span v-else>{{era + 1}} AD</span>
                                </div>
                            </div>

                            <!--<div v-for="era in eras" class="century-block" :id="era" :style="{width: `${yearUnit * eraDuration}px`}">-->
                            <!--    <div class="era-label">-->
                            <!--        <span v-if="era < 0">{{-era}} BC</span>-->
                            <!--        <span v-else>{{era + 1}} AD</span>-->
                            <!--    </div>-->
                            <!--</div>-->

                        </div>

                        <div id="verticalMarkers">
                        </div>

                        <div id="watercolors">

                            <div v-for="event in timelineEls.images" :id="event.idString" class="item-wrapper eventPos image" :class="{hardFocus: event.hasFocus}" :style="{color: event.arc ? event.arc.color : '#bbb', left: `${event.totalDays*dayUnit}px`, bottom: `${event.relY}px`}">

                                <img v-if="event.eventType == 'image'" class="watercolor" :src="event.img" loading="eager" :style="{width: event.width+'px', transform: `translate(${event.offset}%, -50%)`}" />

                                <div class="content" v-if="isAdmin">

                                    <div class="line" :style="{height: event.relY+'px'}">
                                        <div class="date-tag">{{event.dateStr}}</div>
                                    </div>

                                    <div class="time-card-wrapper" @mouseenter="pauseZoom()" @mouseleave="allowZoom()">
                                        <div class="time-card event-info-layout">

                                            <div class="buttons">
                                                <a v-if="isAdmin" class="editButton" @click="openEditForm(event)"><i class="material-icons">create</i></a>
                                            </div>

                                        </div>

                                        <div class="pointer-wrapper">
                                            <div class="pointer"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>


                        </div>

                        <div id="books">
                            <div v-for="book in books" class="book-label-wrapper" :style="{position: 'absolute', bottom: `calc(2*${book.step}em - 1px`, left: (book.startYear-startYear)*yearUnit+'px', width: ((book.endYear-book.startYear)*yearUnit) + 1 +'px'}">
                                <div class="era-label">{{book.name}}</div>
                            </div>    
                        </div>

                        <div id="gallery">

                            <!--<div style="border:1em solid red; position: absolute; top: 25%" :style="{left: (initCenterYear-startYear) * yearUnit+'px'}"></div>-->


                            <div v-for="arc in timelineEls.arcs" class="arc-group item-wrapper" :class="{hardFocus: arc.hasFocus}" :style="{color: arc.color}">
                                <svg v-if="arc.points && arc.points.length > 1" :style="{position: 'absolute', left: arc.left*dayUnit-3, bottom: arc.base}" :height="arc.top-arc.base" :width="(arc.right-arc.left)*dayUnit+6">
                                    <line v-for="i in arc.points.length" v-if="arc.points[i]"
                                        :x1="(arc.points[i-1].totalDays - arc.left)*dayUnit+3" :y1="arc.points[i-1].relY - arc.base"
                                        :x2="(arc.points[i].totalDays - arc.left)*dayUnit+3" :y2="arc.points[i].relY - arc.base"
                                        :style="{stroke: arc.color}" />
                                </svg>


                                <div class="content">
                                    <div class="time-card event-info-layout" :style="{left: `${arc.left*dayUnit}px`, bottom: `calc(${Math.max(arc.base, 0)}px - 0em)`}">
                                        <div class="info">
                                            <div class="title">{{arc.name}}</div>
                                            <div class="details">
                                                <div class="date">{{arc.dateStr}}</div>
                                                <div class="place">{{arc.loc}}</div>

                                                <div v-if="arc.note" class="long-details">
                                                    <div class="note" v-if="arc.note">{{arc.note}}</div>
                                                </div>

                                            </div>
                                        </div>

                                        <div class="buttons">
                                            <a v-if="isAdmin" class="editButton" @click="openEditForm(arc)"><i class="material-icons">create</i></a>
                                            <a v-if="arc.scriptureLink" :href="arc.scriptureLink" target="_blank"><i class="material-icons">import_contacts</i></a>
                                            <a v-if="arc.recId" class="openRecord" @click="setTheaterRecord(arc.recId)"><i class="material-icons">description</i></a>
                                        </div>

                                    </div>
                                </div>

                            </div>


                            <div v-for="event in timelineEls.events" :id="event.idString" class="item-wrapper eventPos" :class="{anchor: event.eventType == 'anchor', secondary: event.eventType == 'secondary', image: event.eventType == 'image', hardFocus: event.hasFocus, hidden: event.eventType == 'secondary' && ( (event.hasLeftNbr && event.daysLeft*dayUnit < minEventDistance) || (event.hasRightNbr && event.daysRight*dayUnit < minEventDistance))}"
                                :style="{color: event.arc ? event.arc.color : 'var(--blue)', left: `${event.totalDays*dayUnit}px`, bottom: `${event.relY}px`}">

                                <div v-if="event.customIcon" class="marker custom-icon-marker">{{event.customIcon}}</div>
                                <div v-else class="marker"></div>

                                <div class="content">

                                    <div class="line" :style="{height: `calc(${event.relY}px - .2em)`}">
                                        <div class="date-tag">{{event.dateStr}}</div>
                                    </div>

                                    <div class="time-card-wrapper" @mouseenter="pauseZoom()" @mouseleave="allowZoom()">
                                        <div class="time-card event-info-layout">
                                            <div v-if="event.img && event.eventType != 'image'" class="event-image">
                                                <img :src="event.img" :alt="event.name" loading="lazy">
                                                <div class="openTheater" @click="setTheaterImageByObj(event)"><i class="material-icons">fullscreen</i></div>
                                            </div>

                                            <div class="info">
                                                <div class="title"><span v-if="event.customIcon">{{event.customIcon}} </span>{{event.name}}</div>
                                                <div class="details">
                                                    <div class="date" v-if="event.dateStr"><i class="material-icons">event</i> {{event.dateStr}}</div>
                                                    <div class="place" v-if="event.loc"><i class="material-icons">location_on</i> <a href="#" @click="openMenuToPlace(event.loc)">{{event.loc}}</a></div>

                                                    <div v-if="event.note || event.lists[0] || event.prophecies[0]" class="long-details">
                                                        <div class="note" v-if="event.note">{{event.note}}</div>
                                                        <div class="list lists" v-if="event.lists[0]"><span v-for="list in event.lists"><a href="#" @click="openMenuToList('lists', list)">{{list}}</a></span></div>
                                                        <div class="list prophecies" v-if="event.prophecies[0]"><span v-for="prophecy in event.prophecies"><a href="#" @click="openMenuToList('prophecies', prophecy)">{{prophecy}}</a></span></div>
                                                    </div>

                                                </div>
                                            </div>

                                            <div class="buttons">
                                                <a class="editButton" @click="openEditForm(event)"><i class="material-icons">create</i></a>
                                                <a title="Open in the menu."><i class="material-icons" @click="openMenuToEvent(event.idString)">sort</i></a>
                                                <a title="Open in the scriptures." v-if="event.scriptureLink" :href="event.scriptureLink" target="_blank"><i class="material-icons">import_contacts</i></a>
                                                <a title="View stylized document." v-if="event.recId" class="openRecord" @click="setTheaterRecord(event.recId)"><i class="material-icons">description</i></a>
                                            </div>

                                        </div>

                                        <div class="pointer-wrapper">
                                            <div class="pointer"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>


                    <div v-if="isLoading" id="loadingSplash"></div>

                    <div id="controls">
                        <div id="zoomBox">
                            <div class="hamburger-container" :class="{disabled: addingItem || editingItem }" @click="toggleMenu">
                                <div class="bar1"></div>
                                <div class="bar2"></div>
                                <div class="bar3"></div>
                            </div>

                            <div id="zoomIn" @click="handleButtonZoomIn()" class="material-icons btn btn-sm btn-light zoom" :disabled="yearUnit >= this.maxYearUnit">zoom_in</div>
                            <div id="resetZoom" @click="resetZoom()" class="material-icons btn btn-sm btn-light zoom">home</div>
                            <div id="zoomOut" @click="handleButtonZoomOut()" class="material-icons btn btn-sm btn-light zoom" :disabled="yearUnit <= this.minYearUnit">zoom_out</div>
                            <!--<div class="range-wrapper">-->
                            <!--    <input type="range" v-model="yearUnit" :min="minYearUnit" :max="maxYearUnit">-->
                            <!--</div>-->
                        </div>

                        <div id="addEventBox" v-if="!(addingItem || editingItem)">
                            <!-- <div id="startQuiz" @click="showQuiz = true" class="btn btn-sm btn-primary">Quiz Me!</div> -->
                            <div v-if="isAdmin">
                                <div id="addEvent" @click="openAddForm('event')" class="btn btn-sm btn-light">+ Add Event</div>
                                <div id="addArc" @click="openAddForm('arc')" class="btn btn-sm btn-light">+ Add Arc</div>
                                <div id="logout" @click="logoutAdmin" class="btn btn-sm btn-light">Logout</div>
                            </div>
                            <div class="material-icons" style="cursor: pointer" @click="openMenuToTab('contact-tab')">help</div>
                        </div>
                    </div>

                    <!--<div v-if="menuIsOpen && isMobile" id="menuCloserSplash" @click="toggleMenu()"></div>-->

                </div>

                <div id="right_panel" class="side-panel" :class="{open: addingItem || editingItem}">
                    <div class="content-wrapper">

                        <form @submit.prevent="handleSubmitForm()">

                            <h4 v-if="editingItem">Editing {{tempItem.type}}</h4>
                            <h4 v-if="addingItem">Adding {{tempItem.type}}</h4>

                            <p>
                                <label for="name">Name</label><br>
                                <input id="name" v-model="tempItem.name">
                            </p>


                            <div v-if="tempItem.type == 'event'">

                                <div v-if="isAdmin">
                                    Type of Event:
                                    <select v-model="tempItem.eventType" style="text-transform: capitalize;">
                                        <option v-for="type in eventTypes" :value="type">{{type}}</option>
                                    </select>
                                </div>

                                <div>
                                    <label for="color">Color</label><br>
                                    <input type="color" id="color" v-model="tempItem.color">
                                    <input type="reset" class="btn btn-light btn-sm" @click="tempItem.color = null" value="Remove Color">
                                </div>

                                <div>
                                    <label for="customIcon">Custom Icon</label><br>
                                    <input id="customIcon" list="iconList" maxlength="2" v-model="tempItem.customIcon">
                                    <datalist id="iconList">
                                        <option v-for="option in getOptionsFor(timelineEls.events, 'customIcon')"
                                            :value="option"></option>
                                    </datalist>
                                </div>

                                <div>
                                    <label for="loc">Location</label><br>
                                    <input id="loc" list="locList" v-model="tempItem.loc">
                                    <datalist id="locList">
                                        <option v-for="option in getOptionsFor(timelineEls.events, 'loc')"
                                            :value="option"></option>
                                    </datalist>
                                </div>

                                <div>
                                    <label for="img">Image URL</label><br>
                                    <input id="img" v-model="tempItem.img">
                                </div>
                                <div v-if="tempItem.img">
                                    <label for="imgCred">Image Attribution</label><br>
                                    <input id="imgCred" v-model="tempItem.imgCred">
                                </div>

                                <div v-if="isAdmin">
                                    <div>
                                        <label for="year">Year</label><br>
                                        <input id="year" v-model="tempItem.year" @change="handleChangeAddYear" type="number">
                                        <div style="display:flex">
                                            <div>
                                                <label for="month">Month</label><br>
                                                <select id="month" v-model="tempItem.month">
                                                    <option v-for="i in MONTH.length" :value="i-1">{{MONTH[i-1]}}</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label for="day">Day</label><br>
                                                <input id="day" v-model="tempItem.day" type="number" min="1" max="31">
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="pos">Position</label><br>
                                        <input id="pos" v-model="tempItem.pos" type="range" min="6" max="90" step="1">
                                    </div>

                                    <div v-if="tempItem.eventType == 'image'">
                                        <label for="width">Size</label><br>
                                        <input id="width" v-model="tempItem.width" type="range" min="50" max="800" step="1">
                                    </div>
                                    <div v-if="tempItem.eventType == 'image'">
                                        <label for="offset">Offset</label><br>
                                        <input id="offset" v-model="tempItem.offset" type="range" min="-100" max="0" step="1">
                                    </div>
                                </div>

                                <div>
                                    <label for="lists">Lists</label>
                                    <div class="lists-list-wrapper">
                                        <p>
                                            <span v-if="tempItem.lists.length === 0">Not in any lists.</span>

                                            <div class="lists-list-item-wrapper" v-for="list in tempItem.lists">
                                                <span class="lists-lists-item-name">{{list}}</span>
                                                <a class="lists-lists-item-remove" @click="handleRemoveItemFromList('lists', list)"></a>
                                            </div>
                                        </p>
                                        <datalist id="listsList">
                                            <option v-for="option in getOptionsFor(timelineEls.events, 'lists')" :value="option">{{option}}</option>
                                            <option :value="newListName">(Create new)</option>
                                        </datalist>
                                        <p class="lists-list-add-new"><input type="text" list="listsList" v-model="newListName"><input type="reset" class="btn btn-sm btn-primary" @click="handleAddItemToList('lists', newListName)" value="Add to List" :disabled="!newListName.length"></p>
                                    </div>
                                </div>
                                <div>
                                    <label for="lists">Prophecies</label>
                                    <div class="lists-list-wrapper">
                                        <p>

                                            <span v-if="tempItem.prophecies.length === 0">Not linked to any prophecy.</span>

                                            <div class="lists-list-item-wrapper" v-for="prophecy in tempItem.prophecies">
                                                <span class="lists-lists-item-name">{{prophecy}}</span>
                                                <a class="lists-lists-item-remove" @click="handleRemoveItemFromList('prophecies', prophecy)"></a>
                                            </div>
                                        </p>
                                        <datalist id="propheciesList">
                                            <option v-for="option in getOptionsFor(timelineEls.events, 'prophecies')" :value="option">{{option}}</option>
                                            <option :value="newListName">(Create new)</option>
                                        </datalist>
                                        <p class="lists-list-add-new"><input type="text" list="propheciesList" v-model="newProphecyName"><input type="reset" class="btn btn-sm btn-primary" @click="handleAddItemToList('prophecies', newProphecyName)" value="Link To Prophecy" :disabled="!newProphecyName.length"></p>
                                    </div>
                                </div>

                                <div v-if="isAdmin">
                                    <div>
                                        <label for="arcId">Arc</label><br>
                                        <select id="arcId" v-model="tempItem.arcId">
                                            <option :value="null">No arc</option>
                                            <option v-for="arc in arcs" :value="arc._id"
                                                :style="{backgroundColor: arc.color, color: '#fff'}">{{arc.name}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>


                            <div>
                                <label for="scriptureLink">Link to Scripture</label><br>
                                <input id="scriptureLink" v-model="tempItem.scriptureLink">
                            </div>

                            <div>
                                <label for="note">Notes</label><br>
                                <textarea id="note" v-model="tempItem.note"></textarea>
                            </div>



                            <div style="text-align: right">
                                <input type="submit" class="btn btn-sm btn-primary">
                                <input type="reset" @click="handleCancelForm" class="btn btn-sm btn-secondary btn-outline" value="Cancel">
                                <input type="reset" @click="deleteItem(tempItem)" class="btn btn-sm btn-danger btn-outline" value="Delete">
                            </div>
                        </form>


                    </div>
                </div>


                

                <div id="quizOverlay" v-show="showQuiz">


                    <div id="slides_area">
                        <div class="deck_slider">

                            <div v-for="card in quizCards" @click="reverseCard(card)" class="qcard" :class="{reversed: show_Qback, active: card.id === activeQIdx, left: card.id < activeQIdx, right: card.id > activeQIdx}">
                                <div class="qcard-height">
                                    <div class="qcard-content">

                                        <div v-if="!show_Qback">
                                            <div v-if="card.img" class="qcard-image-wrapper">
                                                <img :src="card.img" />
                                            </div>
                                            <div v-else>
                                                <h3>{{card.name}}</h3>
                                            </div>
                                        </div>
                                        <div v-if="show_Qback">
                                            <h5 class="title">{{card.name}}</h5>
                                            <div class="details">
                                                <div class="date">{{card.dateStr}}</div>
                                                <div class="place">{{card.loc}}</div>

                                                <br><br>
                                                <div class="note" v-if="card.note" v-html="card.note" style="white-space: pre-wrap;"></div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>


                        </div>


                        <div id="controls">
                            <button @click="activeQIdx = Math.max(0, activeQIdx - 1)">👈</button>
                            <input v-model="displayQIdx" type="number" min="1" :max="quizCards.length" step="1" style="text-align: center;">
                            <button @click="activeQIdx = Math.min(quizCards.length - 1, activeQIdx + 1)">👉</button>
                        </div>


                        <div id="leaveQuizBox">
                            <div id="leaveQuiz" @click="showQuiz = false" class="btn btn-sm btn-secondary">Leave Quiz</div>
                        </div>

                    </div>

                </div>
            </div>

        </div>

        <div v-show="theaterOn" id="theater" :class="`${theaterMode}`">
            <div id="screen">

                <div id="exitTheater" @click="closeTheater">&times;</div>

                <div id="imageBox" v-if="theaterMode == 'img'" :style="{backgroundImage: `url(${theaterData.img})`}" @click="toggleSubs"></div>

                <div id="recordBox" v-show="theaterMode == 'rec'" :class="{hand: handFont}">
                    <div id="records">

                        <div v-for="rec in records" class="record" :style="{order: rec.order}" :id="`rec_${rec.elId}`">
                            <div class="title" v-html="rec.title"></div>
                            <div class="body" v-html="rec.body"></div>
                        </div>

                    </div>
                </div>

                <div id="toggleFont" v-show="theaterMode == 'rec'" :class="{hand: handFont}"><label for="handFont">Aa</label><input type="checkbox" v-model="handFont" id="handFont"></div>

            </div>
            <div id="subs" v-if="theaterData.hasSubs" :class="{on: subsOn}">
                <div v-if="theaterMode == 'img'">
                    <div class="title">{{theaterData.name}}</div>
                    <div class="date" v-if="!theaterData.img">{{theaterData.dateStr}}</div>
                    <div class="place">{{theaterData.loc}}</div>
                    <p class="notes" v-show="theaterData.note" v-html="theaterData.note"></p>
                </div>
            </div>
        </div>

        <div class="modal-wrapper" :class="{on: showModal}">
            <a @click="closeNote"></a>
            <div class="modal">
                <div class="title-bar">
                    <h2>Project Notes</h2>
                    <a @click="closeNote">&times;</a>
                </div>
                <div class="modal-body">
                    <section v-for="note in notes" :id="`note_${note.elId}`" :style="{order: note.order}">
                        <h3>{{note.title || 'Footnote'}}</h3>
                        <div v-html="note.body"></div>
                    </section>
                    <section id="sources">
                        <h3>References and Further Reading</h3>
                        <ol>
                            <li v-for="src in sources" :id="`note_${src.elId}`" class="source-info">
                                <span v-if="src.who" class="who">{{src.who}}.</span>
                                <span v-if="src.date" class="date">({{src.date}})</span>
                                <span v-if="src.title" class="title"><a :href="src.href">{{src.title}}</a></span>
                                <span v-if="src.pub" class="pub">{{src.pub}}:</span>
                                <span v-if="src.cont" class="cont">{{src.cont}},</span>
                                <span v-if="src.cont_date" class="cont_date">{{src.cont_date}}.</span>
                            </li>
                        </ol>
                    </section>
                </div>
            </div>

        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <script src="gallery.js"></script>
    <script src="index.js"></script>

</body>

</html>
